#-*- coding: utf-8 -*-
import os
import sys
# Written by Leonidus0x10
# I NEED TO LEARN THREADING TO MAKE THIS SHIT FASTER
file = sys.argv[1]

with open(file, "r") as target_list:
    targets = target_list.readlines()
    for line in targets:
        try:
            t = line.split(" ")[1]
            target = t.strip("\n")
            command = f"rpcdump.py @{target} | grep MS-RPRN"

            print(f"trying: {target}")
            output = os.popen(command).read()
            if "MS-RPRN" in output:
                print(f"{target}: is vulnerable saving to file!")
                with open("vulnerable.txt", "a") as vuln_list:
                    vuln_list.write(target + "\n")
        except Exception as e:
           print("error")
